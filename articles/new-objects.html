<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Setting up new objects • EndoSim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setting up new objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EndoSim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/EndoSim.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/new-objects.html">Setting up new objects</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cesaraustralia/EndoSim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Setting up new objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cesaraustralia/EndoSim/vignettes/new-objects.Rmd" class="external-link"><code>vignettes/new-objects.Rmd</code></a></small>
      <div class="d-none name"><code>new-objects.Rmd</code></div>
    </div>

    
    
<p><code>EndoSim</code> is designed in a modular fashion. Input objects
are, in general, lists of functions, where each function accepts a
single numeric vector input ( <em>e.g.,</em> temperature, days after
emergence) and returns a numeric vector output of the same length.</p>
<p>For example, in the <code>pest()</code> object, the argument
<code>fun_dev_apt</code> accepts a function describing
temperature-dependent development of nymphs destined to become apterae.
This function should accept as its input daily temperature and return a
corresponding number, ranging from 0-1. The input can be a vector of
length 1:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1376906</span></span></code></pre></div>
<p>Or a longer vector:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">38</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.00000000 0.09255006 0.13769057 0.00000000</span></span></code></pre></div>
<p>For the supplied <code>pest()</code> object for <em>Myzus
persicae</em>, <code>GPA</code>, this function is currently defined
using the Wang model for development (set up using the internal function
<code>EndoSim:::fit_wang()</code>). However, we can easily replace this
with a different function. This can be done using one of the internal
functions provided with the <code>EndoSim</code> package. For example,
say we want to use a Gaussian function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span> <span class="op">&lt;-</span> <span class="fu">EndoSim</span><span class="fu">:::</span><span class="fu"><a href="../reference/fit_gaussian.html">fit_gaussian</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">25</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-objects_files/figure-html/function%20replacement%201-1.png" width="576"></p>
<p>The internal functions come with documentation explaining what the
input arguments for each are (generally parameters defining the shape
and range of the function), and what the resultant function is -
<em>i.e.,</em> what is its required input and what is the range of
output values it produces. This can make it easy to set up new objects
that have similar functional responses as the ones supplied with the
package, but may differ in the shape or range. For example, if we want
to model a different aphid pest that has narrower thermal preferences
and a lower optimal temperature:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span> <span class="op">&lt;-</span> <span class="fu">EndoSim</span><span class="fu">:::</span><span class="fu"><a href="../reference/fit_gaussian.html">fit_gaussian</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-objects_files/figure-html/function%20replacement%202-1.png" width="576"></p>
<p>Using the internal functions is not a requirement - we can also write
custom functions to represent different processes. However, we strongly
urge users to take caution when writing their own functions, since they
could potentially return values which are nonsensical or “break” the
model. For example, we could write a function where the returned
development units change linearly with temperature, but not include
bounds which prevent the returned values from being negative:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">2</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-objects_files/figure-html/function%20replacement%203-1.png" width="576"></p>
<p>Running a model with this function can lead to downright weird
results because of nonsensical development rates:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endosim.html">endosim</a></span><span class="op">(</span>Pest <span class="op">=</span> <span class="va">GPA</span>,</span>
<span>                 Endosymbiont <span class="op">=</span> <span class="va">Rickettsiella</span>,</span>
<span>                 Crop <span class="op">=</span> <span class="va">Canola</span>,</span>
<span>                 Parasitoid <span class="op">=</span> <span class="va">DR</span>,</span>
<span>                 init <span class="op">=</span> <span class="va">init</span>,</span>
<span>                 conds <span class="op">=</span> <span class="va">Aroonda</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 imi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 emi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 vert_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 hori_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 para <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="st">"demo"</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-objects_files/figure-html/function%20replacement%204-1.png" width="576"></p>
<p>Also note that we could, theoretically, use a function that returns a
non-numeric output, or an output of different length to the input. This
could simply result in the model failing to run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_dev_apt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="st">"this is a text output"</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endosim.html">endosim</a></span><span class="op">(</span>Pest <span class="op">=</span> <span class="va">GPA</span>,</span>
<span>                 Endosymbiont <span class="op">=</span> <span class="va">Rickettsiella</span>,</span>
<span>                 Crop <span class="op">=</span> <span class="va">Canola</span>,</span>
<span>                 Parasitoid <span class="op">=</span> <span class="va">DR</span>,</span>
<span>                 init <span class="op">=</span> <span class="va">init</span>,</span>
<span>                 conds <span class="op">=</span> <span class="va">Aroonda</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 imi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 emi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 vert_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 hori_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 para <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in dev_cohorts[, c(1, 2)] + dev_apt: non-numeric argument to binary operator</span></span></code></pre></div>
<div class="section level3">
<h3 id="turning-processes-on-and-off">Turning processes on and off<a class="anchor" aria-label="anchor" href="#turning-processes-on-and-off"></a>
</h3>
<p>Because all objects include functions as arguments, a process can be
easily turned off or fixed ( <em>i.e.,</em> made not dependent on its
input) by using the internal <code>EndoSim:::fit_null()</code> function.
This function accepts as an input a user-determined value, and returns a
function which returns this value as an output regardless of the input -
but crucially, of the same length. Some examples:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_func</span> <span class="op">&lt;-</span> <span class="fu">EndoSim</span><span class="fu">:::</span><span class="fu"><a href="../reference/fit_null.html">fit_null</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">my_func</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span></span>
<span><span class="fu">my_func</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5 5 5 5</span></span>
<span></span>
<span><span class="fu">my_func</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span></span>
<span><span class="va">my_func</span> <span class="op">&lt;-</span> <span class="fu">EndoSim</span><span class="fu">:::</span><span class="fu"><a href="../reference/fit_null.html">fit_null</a></span><span class="op">(</span><span class="st">"null"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">my_func</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "null"</span></span>
<span></span>
<span><span class="fu">my_func</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "null" "null" "null" "null"</span></span></code></pre></div>
<p>Because the output is always of the same length, using
<code><a href="../reference/fit_null.html">fit_null()</a></code> doesn’t break the model due to inconsistent
lengths of objects.</p>
<p>Turning off a process is as simple as passing to it
<code>fit_null(0)</code> or <code>fit_null(1)</code> - this makes sure
the output for that process is always 0 or 1. Which one to choose
depends on the process, and whether “turning it off” means the returned
value should be 0 or 1.</p>
<p>For instance, disabling age-dependent mortality can be done by
replacing the <code>fun_sen_loss()</code> function so that the returned
value is 0. In this way, there is no mortality associated with the age
of the cohort (senescense), since the number of aphid deaths due to
senescense are always 0, and mortality is modelled as an additive
process.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_sen_loss</span> <span class="op">&lt;-</span> <span class="fu">EndoSim</span><span class="fu">:::</span><span class="fu"><a href="../reference/fit_null.html">fit_null</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endosim.html">endosim</a></span><span class="op">(</span>Pest <span class="op">=</span> <span class="va">GPA</span>,</span>
<span>                 Endosymbiont <span class="op">=</span> <span class="va">Rickettsiella</span>,</span>
<span>                 Crop <span class="op">=</span> <span class="va">Canola</span>,</span>
<span>                 Parasitoid <span class="op">=</span> <span class="va">DR</span>,</span>
<span>                 init <span class="op">=</span> <span class="va">init</span>,</span>
<span>                 conds <span class="op">=</span> <span class="va">Aroonda</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 imi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 emi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 vert_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 hori_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 para <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-objects_files/figure-html/fit_null%20replacement%201-1.png" width="576"></p>
<p>On the other hand, disabling age-dependent reproduction by replacing
the <code>fun_age_fecund()</code> function, requires a value of 1.
Because the total growth rate is a multiplication of temperature-,
density- and age-related contributions, fixing this value to 1
effectively removes the “contribution” of age - growth rates no longer
depend on the age of the cohort.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GPA</span><span class="op">@</span><span class="va">fun_age_fecund</span> <span class="op">&lt;-</span> <span class="fu">EndoSim</span><span class="fu">:::</span><span class="fu"><a href="../reference/fit_null.html">fit_null</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endosim.html">endosim</a></span><span class="op">(</span>Pest <span class="op">=</span> <span class="va">GPA</span>,</span>
<span>                 Endosymbiont <span class="op">=</span> <span class="va">Rickettsiella</span>,</span>
<span>                 Crop <span class="op">=</span> <span class="va">Canola</span>,</span>
<span>                 Parasitoid <span class="op">=</span> <span class="va">DR</span>,</span>
<span>                 init <span class="op">=</span> <span class="va">init</span>,</span>
<span>                 conds <span class="op">=</span> <span class="va">Aroonda</span>,</span>
<span>                 plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 imi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 emi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 vert_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 hori_trans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 para <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="new-objects_files/figure-html/fit_null%20replacement%202-1.png" width="576"></p>
<p>Again - this functionality should be used with caution since it could
lead to nonsensical results.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Slavenko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
